<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
  <title>Random MST3K-O-Matic</title>
  <script>if (typeof module === 'object') { window.module = module; module = undefined; }</script>
  <script type="text/javascript" src="./scripts/jquery-1.11.3.min.js"></script>
  <script type="text/javascript" src="./scripts/skeletabs.js"></script>
  <script type="text/javascript" src="./scripts/jquery.magnific-popup.js"></script>
  <script type="text/javascript" src="./scripts/jquery.ddslick.min.js"></script>
  <script type="text/javascript" src="./scripts/jquery.imgcheckbox.js"></script>
  <link href="./scripts/matic.css" rel="stylesheet" type="text/css">
  <link href='./scripts/skeletabs.css' rel='stylesheet' type='text/css'>
  <link href='./scripts/magnific-popup.css' rel='stylesheet' type='text/css'>
  <script>
    const { ipcRenderer } = require('electron');
  </script>
</head>

<body>
  <h2 id="quote"style="text-align:center;">&nbsp;</h2>
  <div id="tabContainer" class="skltbs-theme-light">
    <ul class="skltbs-tab-group">
      <li class="skltbs-tab-item">
        <button class="skltbs-tab">The Hosts</button>
      </li>
      <li class="skltbs-tab-item">
        <button class="skltbs-tab">The Mads</button>
      </li>
      <li class="skltbs-tab-item">
        <button class="skltbs-tab">The Options</button>
      </li>
    </ul>
    <div class="skltbs-panel-group">
      <div class="skltbs-panel">
        <table style="width:100%;">
          <tr><td style="color:white;">Choose A Host:<br/>
            <select id="theHost">
              <option value="IS NOT NULL" data-imagesrc="images/johnny.jpg" data-description="Why doesn't Johnny care?">I don't care!</option>
              <option value="= 'jh'" data-imagesrc="images/joel.jpg" data-description="&quot;Joel Robinson&quot;<br/>Seasons K-5">Joel Hodgson</option>
              <option value="= 'mn'" data-imagesrc="images/mike.jpg" data-description="&quot;Mike Nelson&quot;<br/>Seasons 5-10">Mike Nelson</option>
              <option value="= 'jr'" data-imagesrc="images/jonah.jpg" data-description="&quot;Jonah Heston&quot;<br/>Seasons 11-Present">Jonah Ray</option>
              <option value="= 'em'" data-imagesrc="images/emily.jpg" data-description="&quot;Emily Connor&quot;<br/>Season 13-Present">Emily Marsh</option>
            </select>
          </td>
          <td style="color:white;">Choose A Crow:<br/>
            <select id="theCrow">
              <option value="IS NOT NULL" data-imagesrc="images/johnny.jpg" data-description="Why doesn't Johnny care?">I don't care!</option>
              <option value="= 'jw'" data-imagesrc="images/josh.jpg" data-description="Season K">Josh Weinstein</option>
              <option value="= 'tb'" data-imagesrc="images/trace.jpg" data-description="Seasons K-7">Trace Beaulieu</option>
              <option value="= 'bc'" data-imagesrc="images/bill.jpg" data-description="Seasons 8-10">Bill Corbett</option>
              <option value="= 'hyt'" data-imagesrc="images/hampton.jpg" data-description="Seasons 11-Present">Hampton Yount</option>
              <option value="= 'kab'" data-imagesrc="images/kelsey.jpg" data-description="Seasons 13-Present">Kelsey Ann Brady</option>
            </select>
          </td><td style="color:white;">Choose A Tom Servo:<br/>
            <select id="theTom">
              <option value="IS NOT NULL" data-imagesrc="images/johnny.jpg" data-description="Why doesn't Johnny care?">I don't care!</option>
              <option value="= 'jw'" data-imagesrc="images/josh.jpg" data-description="Seasons K-1,13">Josh Weinstein</option>
              <option value="= 'km'" data-imagesrc="images/kevin.jpg" data-description="Seasons 2-10">Kevin Murphy</option>
              <option value="= 'bv'" data-imagesrc="images/baron.jpg" data-description="Seasons 11-Present">Baron Vaughn</option>
              <option value="= 'cm'" data-imagesrc="images/conor.jpg" data-description="Seasons 13-Present">Conor McGiffin</option>
            </select>
          </td></tr>
          </table>
      </div>
      <div class="skltbs-panel">
          <table style="width:100%">
            <tr>
              <td style="text-align:center;color:white;"><img class="madsImage" name="drf" src="images/drf.jpg"><br/>Dr. Clayton Forrester<br/><span style="font-size:.8em;">Trace Beaulieu<br/>Seasons K-7</span></td>
              <td style="text-align:center;color:white;"><img class="madsImage" name="larry" src="images/larry.jpg"><br/>Dr. Larry Erhardt<br/><span style="font-size:.8em;">Josh Weinstein<br/>Seasons K-1</span></td>
              <td style="text-align:center;color:white;"><img class="madsImage" name="frank" src="images/frank.jpg"><br/>TV's Frank<br/><span style="font-size:.8em;">Frank Conniff<br/>Seasons 2-6, 10</span></td>
              <td style="text-align:center;color:white;"><img class="madsImage" name="pearl" src="images/pearl.jpg"><br/>Pearl Forrester<br/><span style="font-size:.8em;">Mary Jo Pehl<br/>Seasons 6-11, 13</span></td>
              <td style="text-align:center;color:white;"><img class="madsImage" name="bobo" src="images/bobo.jpg"><br/>Professor Bobo<br/><span style="font-size:.8em;">Kevin Murphy<br/>Seasons 8-11</span></td>
            </tr>
            <tr>
              <td style="text-align:center;color:white;"><img class="madsImage" name="observer" src="images/observer.jpg"><br/>Observer<br/><span style="font-size:.8em;">Bill Corbett<br/>Seasons 8-11</span></td>
              <td style="text-align:center;color:white;"><img class="madsImage" name="kinga" src="images/kinga.jpg"><br/>Kinga Forrester<br/><span style="font-size:.8em;">Felicia Day<br/>Season 11-Present</span></td>
              <td style="text-align:center;color:white;"><img class="madsImage" name="max" src="images/max.jpg"><br/>Max<br/><span style="font-size:.8em;">Patton Oswalt<br/>Seasons 11-Present</span></td>
              <td style="text-align:center;color:white;"><img class="madsImage" name="synthia" src="images/synthia.jpg"><br/>Synthia<br/><span style="font-size:.8em;">Rebecca Hanson<br/>Seasons 11-Present</span></td>
              <td style="text-align:center;color:white;"><img class="madsImage" name="megasynthia" src="images/megasynthia.jpg"><br/>Mega-Synthia<br/><span style="font-size:.8em;">Yvonne Freese<br/>Seasons 13-Present</span></td>
            </tr>
          </table>
      </div>
      <div class="skltbs-panel">
        <table style="width:100%">
            <tr>
              <td style="text-align:center;color:white;"><img class="optionsImage" src="images/short.jpg"><br/>Only show episodes with shorts</td>
              <td style="text-align:center;color:white;"><img class="optionsImage" src="images/streaming.png"><br/>Only show episodes available for streaming</td>
            </tr>
            <tr>
              <td style="text-align:center;color:white;"><img class="optionsImage" src="images/short.jpg"><br/>Only show black and white movies</td>
              <td style="text-align:center;color:white;"><img class="optionsImage" src="images/streaming.png"><br/>Only show episodes available for streaming</td>
            </tr>
        </table>
      </div>
    </div>
  </div>
  <div class="footer">
    <input type="button" class="fakeSkeletab" id="movieSign" value="Push the button, Frank.">
  </div>
  <div id="movieSignPopup" class="white-popup mfp-hide">
    <h2 style="width:100%; text-align:center; color:black;" id="experimentID"></h2>
    <h1 style="width:100%; text-align:center; color:black;" id="result"></h1>
    <div style="width: 100%; text-align:center;">
      <img id="moviePoster" src="">
    </div>
    <div style="text-align:center; width:100%; padding-top:20px;">
        <div class="streamTD" id="amazonTD"><a id="amazonURL" href="" target="_blank"><img src="images/amazon.svg" style="height:50px;"></a></div>
        <div class="streamTD" id="huluTD"><a id="huluURL" href="" target="_blank"><img src="images/hulu.svg" style="height:50px;"></a></div>
        <div class="streamTD" id="itunesTD"><a id="itunesURL" href="" target="_blank"><img src="images/itunes.svg" style="height:50px;"></a></div>
        <div class="streamTD" id="mst3kTD"><a id="mst3kURL" href="" target="_blank"><img src="images/mst3k.png" style="height:50px;"></a></div>
        <div class="streamTD" id="netflixTD"><a id="netflixURL" href="" target="_blank"><img src="images/netflix.svg" style="height:50px;"></a></div>
        <div class="streamTD" id="rifftraxTD"><a id="rifftraxURL" href="" target="_blank"><img src="images/rifftrax.png" style="height:50px;"></a></div>
        <div class="streamTD" id="shoutTD"><a id="shoutURL" href="" target="_blank"><img src="images/shout.svg" style="height:50px;"></a></div>
        <div class="streamTD" id="vhxTD">VHX</div>
        <div class="streamTD" id="vimeoTD"><a id="vimeoURL" href=" target="_blank"><img src="images/vimeo.svg" style="height:50px;"></a></div>
        <div class="streamTD" id="youtubeTD"><a id="youtubeURL" href="" target="_blank"><img src="images/youtube.svg" style="height:50px;"></a></div>
        <div class="streamTD"><a id="refresh" href=""><img src="images/reload.svg" style="height:50px;"></a></div>
    </div>
  </div>
  <div id="noMovie" class="white-popup mfp-hide">
    <div style="width: 100%; text-align:center;">
      <img src="images/poopie.jpg">
    </div>
    <h2 style="width:100%; text-align:center; color:black;">Sorry, no movies were found that match your criteria.  Try again!</h2>
  </div>
  <div id="pleaseWait" class="white-popup mfp-hide">
    <h1 style="text-align:center; color:black;">Communicating With Deep 13, Please Wait...</h1>
    <div style="position:absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">
      <img src="images/mst3k.png" class="rotate" style="height:350px;">
    </div>
    <!--<div style="position:relative; width: 100%; height: 100%; text-align:center; border:1px solid blue;">
      HI THERE
    </div>-->
    
</body>
<script>

getQuote()

$(document).ready(function() {
  $('#theHost').ddslick();
  $("#theCrow").ddslick();
  $("#theTom").ddslick();
  $("img.madsImage").imgCheckbox();
  $("img.optionsImage").imgCheckbox();
/*   $.magnificPopup.open({
      items: {
        src: '#pleaseWait'
      },
      type: 'inline',
      modal: true
    }); */
})

$('#tabContainer')
  .on('skeletabs:move', function(event, info) {
    getQuote()
  })
  .skeletabs();

$("#refresh").on("click",function(e) {
  e.preventDefault()
  $("#movieSign").click()
})

$("#movieSign").on("click",function(e){
  $("#result").html("")
  let data = {}
  let mads = []
  let options = []
  
  $(".madsImage").each(function(){
    if ($(this).parent().hasClass("imgChked")) {
      let obj = {}
      obj[$(this).attr("name")] = 1
      mads.push(obj)
    }
  })

  $(".options").each(function(){
    if ($(this).parent().hasClass("imgChked")) {
      let obj = {}
      obj[$(this).attr("name")] = 1
      options.push(obj)
    }
  })

  data.host = $("#theHost").data('ddslick').selectedData.value
  data.crow = $("#theCrow").data('ddslick').selectedData.value
  data.tom = $("#theTom").data('ddslick').selectedData.value
  data.mads = mads
  data.options = options
  ipcRenderer.send('movie-request', data)
})

ipcRenderer.on('movie-sign', (event, data) => { 
  console.log(data.movie)
  if (data.rows == 0) { 
    $.magnificPopup.open({
      items: {
        src: '#noMovie'
      },
      type: 'inline'
    });
  } else {
    let streams = 1
    if (data.movie.amazon != null) {
      $("#amazonTD").css("display","inline-block")
      $("#amazonURL").attr("href", data.movie.amazon)
      streams++
    } else {
      $("#amazonTD").css("display","none")
      $("#amazonURL").attr("href", "")
    }
    if (data.movie.hulu != null) {
      $("#huluTD").css("display","inline-block")
      $("#huluURL").attr("href","https://www.hulu.com/watch/"+data.movie.hulu)
      streams++
    } else {
      $("#huluTD").css("display","none")
      $("#huluURL").attr("href","")
    }
    if (data.movie.itunes != null) {
      $("#itunesTD").css("display","inline-block")
      $("#itunesURL").attr("href","https://itunes.apple.com/us/movie/mystery-science-theater-3000/"+data.movie.itunes)
      streams++
    } else {
      $("#itunesTD").css("display","none")
      $("#itunesURL").attr("href","")
    }
    if (data.movie.mst3k != null) {
      $("#mst3kTD").css("display","inline-block")
      $("#mst3kURL").attr("href","http://www.mst3k.com/"+data.movie.mst3k)
      streams++
    } else {
      $("#mst3kTD").css("display","none")
      $("#mst3kURL").attr("href","")
    }
    if (data.movie.netflix != null) {
      $("#netflixTD").css("display","inline-block")
      $("#netflixURL").attr("href","https://www.netflix.com/watch/"+data.movie.netflix)
      streams++
    } else {
      $("#netflixTD").css("display","none")
      $("#netflixURL").attr("href","")
    }
    if (data.movie.rifftrax != null) {
      $("#rifftraxTD").css("display","inline-block")
      $("#rifftraxURL").attr("href","http://www.rifftrax.com/mst3k-"+data.movie.rifftrax)
      streams++
    } else {
      $("#rifftraxTD").css("display","none")
      $("#rifftraxURL").attr("href","")
    }
    if (data.movie.shout != null) {
      $("#shoutTD").css("display","inline-block")
      $("#shoutURL").attr("href","watch.shout-tv.com/video/"+data.movie.shout)
      streams++
    } else {
      $("#shoutTD").css("display","none")
      $("#shoutURL").attr("href","")
    }
    if (data.movie.vhx != null) {
      $("#vhxTD").css("display","inline-block")
      $("#vxhURL").attr("href","https://mst3k.vhx.tv/products/"+data.movie.vhx)
      streams++
    } else {
      $("#vhxTD").css("display","none")
      $("#vxhURL").attr("href","")
    }
    if (data.movie.vimeo != null) {
      $("#vimeoTD").css("display","inline-block")
      $("#vimeoURL").attr("href","https://vimeo.com/ondemand/mst3k/"+data.movie.vimeo)
      streams++
    } else {
      $("#vimeoTD").css("display","none")
      $("#vimeoURL").attr("href","")
    }
    if (data.movie.youtube != null) {
      $("#youtubeTD").css("display","inline-block")
      $("#youtubeURL").attr("href","https://www.youtube.com/watch?v="+data.movie.youtube)
      streams++
    } else {
      $("#youtubeTD").css("display","none")
      $("#youtubeURL").attr("href","")
    }
    $(".streamTD").css("width",100/streams+"%")
    $("#experimentID").html("Experiment "+data.movie.experiment+":")
    $("#result").html("&quot;"+data.movie.movie+"&quot;")
    $("#moviePoster").attr("src","epthumbs/"+data.movie.experiment+".jpg")
    $("#streamingServices").html(JSON.stringify(streams))
    $.magnificPopup.open({
      items: {
        src: '#movieSignPopup'
      },
      type: 'inline'
    });
    
  }
})

ipcRenderer.on('quote-response', (event, data) => {
  $("#quote").html(data.quote)
})

ipcRenderer.on('hide-spinner', (event, data) => {
  console.log(data)
  $.magnificPopup.close();
})

function getQuote() {
  ipcRenderer.send('get-quote',$("#quote").html())
}
</script>

</html>